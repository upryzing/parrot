name: Release Webhook

on:
  workflow_dispatch:
  release:
    types: [published]

jobs:
  release-webhook:
    name: Send Release Webhook
    runs-on: ubuntu-latest

    steps:
      - name: Send release notification webhook
        run: |
          RELEASE_URL="https://github.com/${{ github.repository }}/releases/tag/${{ needs.release-please.outputs.tag_name }}"
          curl -X POST "${{ secrets.STOAT_WEBHOOK_UPDATES_URL }}" \
            -H "Content-Type: application/json" \
            -d "{\"content\": \"$RELEASE_URL\"}"
